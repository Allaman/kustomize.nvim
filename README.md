# kustomize.nvim

I work a lot with [Kustomize](https://kustomize.io/) and I love Neovim. So why not write a plugin for some tasks for that I usually switch to a shell.

âš  This is my first Neovim plugin so any Feedback is appreciated!

![](https://gifyu.com/image/ShzzC)

## Requirements

- kustomize must be installed and in your $PATH
- [plenary.nvim](https://github.com/nvim-lua/plenary.nvim)

## Quickstart

With Packer:

```lua
  use({
    "allaman/kustomize.nvim",
    requires = "nvim-lua/plenary.nvim",
    ft = "yaml",
    config = "require('kustomize').setup()",
  })
```

## Default mappings

| Mapping      | Action          | lua                                |
| ------------ | --------------- | ---------------------------------- |
| \<leader\>kb | Kustomize build | `lua require("kustomize").build()` |
| \<leader\>kk | List kinds      | `lua require("kustomize").kinds()` |

You can define your own keybindings. Just don't call `setup()` and bind the lua commands on your own.

## Use cases

### Build manifests

If your buffer contains a `kustomization.yaml` this command will run `kustomize build . ` in the buffer's directory. The generated YAML will printed to a new buffer. The new buffer can be closed by just typing `q`.
This allows me to quickly inspect the YAML that Kustomize generates (and ultimately is applied to the cluster). In addition, I get fast feedback on any errors in my YAML sources.

### List "kinds"

Sometimes, I just want to roughly check the YAMLs generated by Kustomize. A good hint is to check the `kind:` key of the generated YAML manifests. This command will parse all resource types in the current buffer and prints them to a new buffer. The new buffer can be closed by just typing `q`. You could use it on any YAML file with multiple resources, for instance generated by [Build manifests](#build-manifests)

### TODO

- [ ] use treesitter for parsing
- [ ] nicer and configurable output (floating, split, ...)
